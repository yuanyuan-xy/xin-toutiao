(function(e){function t(t){for(var n,r,o=t[0],l=t[1],c=t[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={app:0},s=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0403":function(e,t,a){},"164e":function(e,t){e.exports=echarts},2165:function(e,t,a){"use strict";var n=a("edcd"),i=a.n(n);i.a},"257f":function(e,t){e.exports=tiptap},"35a2":function(e,t,a){},"396c":function(e,t,a){},"46db":function(e,t,a){"use strict";var n=a("9be3"),i=a.n(n);i.a},"4bf7":function(e,t,a){"use strict";var n=a("35a2"),i=a.n(n);i.a},"500a":function(e,t,a){e.exports=a.p+"img/word.c2f99f11.png"},"52cf":function(e,t,a){"use strict";var n=a("396c"),i=a.n(n);i.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("8bbf"),i=a.n(n),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],o={name:"App"},l=o,c=a("2877"),u=Object(c["a"])(l,s,r,!1,null,null,null),d=u.exports,p=a("8c4f"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container"},[a("el-form",{ref:"form",staticClass:"loginForm",attrs:{model:e.user,rules:e.formRule}},[a("el-form-item",[a("div",{staticClass:"logo"})]),a("el-form-item",{attrs:{prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入电话号码"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),a("el-form-item",{attrs:{prop:"code"}},[a("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}})],1),a("el-form-item",{attrs:{prop:"agree"}},[a("el-checkbox",{model:{value:e.user.agree,callback:function(t){e.$set(e.user,"agree",t)},expression:"user.agree"}},[e._v("我已阅读并同意服务手册")])],1),a("el-form-item",[a("el-button",{staticClass:"loginBtn",attrs:{type:"primary",loading:e.loginLoad},on:{click:e.login}},[e._v("立即登录")])],1)],1)],1)},f=[],g=(a("d3b7"),a("bc3a")),h=a.n(g),v=a("d604"),b=a.n(v),_=a("5f72"),C=a.n(_),w=h.a.create({baseURL:"http://ttapi.research.itcast.cn/",transformResponse:[function(e){try{return b.a.parse(e)}catch(t){return console.log(t),e}}]});w.interceptors.request.use((function(e){var t=JSON.parse(window.localStorage.getItem("user"));return t&&(e.headers.Authorization="Bearer ".concat(t.token)),e}),(function(e){return Promise.reject(e)})),w.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return 401===t?(window.localStorage.removeItem("user"),wt.push("/login"),_["Message"].error("登录状态无效，请重新登录")):403===t?Object(_["Message"])({type:"warning",message:"没有操作权限"}):400===t?_["Message"].error("参数错误，请检查请求参数"):t>=500&&_["Message"].error("服务端内部异常，请稍后重试"),Promise.reject(e)}));var x=w,y=function(e){return x({method:"POST",url:"/mp/v1_0/authorizations",data:e})},S=function(){return x({method:"GET",url:"/mp/v1_0/user/profile"})},$=function(e){return x({method:"PATCH",url:"/mp/v1_0/user/photo",data:e})},k=function(e){return x({method:"PATCH",url:"/mp/v1_0/user/profile",data:e})},I={name:"login",data:function(){return{user:{mobile:"13911111111",code:"246810",agree:!0},loginLoad:!1,formRule:{mobile:[{required:!0,message:"请输入电话号",trigger:"blur"},{pattern:/^1[3|5|6|7|8|9]\d{9}$/,message:"电话格式不正确",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{pattern:/^\d{6}$/,message:"验证码格式不正确",trigger:"blur"}],agree:[{validator:function(e,t,a){t?a():a(new Error("请同意服务手册"))},trigger:"change"}]}}},methods:{login:function(){var e=this;this.$refs.form.validate((function(t){t&&e.onLogin()}))},onLogin:function(){var e=this;this.loginLoad=!0,y(this.user).then((function(t){e.$message({message:"登陆成功",type:"success"}),e.loginLoad=!1,window.localStorage.setItem("user",JSON.stringify(t.data.data)),e.$router.push("/")})).catch((function(){e.$message.error("登陆失败,账号或密码错误"),e.loginLoad=!1}))}}},z=I,L=(a("52cf"),Object(c["a"])(z,m,f,!1,null,"3863542a",null)),P=L.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"container"},[a("el-aside",{staticClass:"aside",attrs:{width:"auto"}},[a("layout-aside",{staticClass:"layout-aside",attrs:{isCollapse:e.isCollapse}})],1),a("el-container",[a("el-header",{staticClass:"header"},[a("div",{staticClass:"layout-head"},[a("div",[a("span",{class:{"el-icon-s-fold":e.isCollapse,"el-icon-s-unfold":!e.isCollapse},on:{click:function(t){e.isCollapse=!e.isCollapse}}}),a("span",[e._v("欢迎来到阳光养猪场")])]),a("el-dropdown",[a("div",{staticClass:"select"},[a("img",{staticClass:"user-avatar",attrs:{src:e.user.photo,alt:""}}),a("span",[e._v(e._s(e.user.name))]),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.onSettings(t)}}},[e._v("设置")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.onLogout(t)}}},[e._v("退出")])],1)],1)],1)]),a("el-main",{staticClass:"main"},[a("router-view")],1)],1)],1)},E=[],j=(a("b0c0"),new i.a),T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.path,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:"",collapse:e.isCollapse}},[a("el-menu-item",{attrs:{index:"/"}},[a("i",{staticClass:"el-icon-s-home"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),a("el-menu-item",{attrs:{index:"/article"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("内容管理")])]),a("el-menu-item",{attrs:{index:"/image"}},[a("i",{staticClass:"el-icon-picture"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("素材管理")])]),a("el-menu-item",{attrs:{index:"/publish"}},[a("i",{staticClass:"iconfont iconpublish"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("发布文章")])]),a("el-menu-item",{attrs:{index:"/comment"}},[a("i",{staticClass:"el-icon-chat-dot-round"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("评论管理")])]),a("el-menu-item",{attrs:{index:"/fans"}},[a("i",{staticClass:"iconfont icongift"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("粉丝管理")])]),a("el-menu-item",{attrs:{index:"/settings"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("个人设置")])])],1)},A=[],U={data:function(){return{path:""}},props:["is-collapse"],created:function(){this.getPath()},methods:{getPath:function(){this.path=this.$route.path}}},N=U,V=(a("4bf7"),Object(c["a"])(N,T,A,!1,null,"60f638e8",null)),D=V.exports,q={data:function(){return{user:{},isCollapse:!0}},created:function(){var e=this;this.getProfile(),j.$on("user-info",(function(t){e.user.name=t.name,e.user.photo=t.photo}))},methods:{getProfile:function(){var e=this;S().then((function(t){e.user=t.data.data}))},onLogout:function(){var e=this;this.$confirm("确定退出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.localStorage.removeItem("user"),e.$router.push("/login")})).catch((function(){e.$message({type:"info",message:"已取消退出"})}))},onSettings:function(){this.$router.push("/settings")}},components:{LayoutAside:D}},R=q,B=(a("cfa5"),Object(c["a"])(R,O,E,!1,null,"58b83562",null)),F=B.exports,M=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},G=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("img",{attrs:{src:a("500a"),alt:""}})])}],J={name:"HomeIndex"},H=J,W=(a("ca18"),Object(c["a"])(H,M,G,!1,null,"6112da99",null)),K=W.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"filter-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),n("el-breadcrumb-item",[e._v("内容管理")])],1)],1),n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"label-width":"100px",size:"mini",disabled:e.loading}},[n("el-form-item",{attrs:{label:"状态"}},[n("el-radio-group",{model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[n("el-radio",{attrs:{label:null}},[e._v("全部")]),n("el-radio",{attrs:{label:0}},[e._v("草稿")]),n("el-radio",{attrs:{label:1}},[e._v("待审核")]),n("el-radio",{attrs:{label:2}},[e._v("审核通过")]),n("el-radio",{attrs:{label:3}},[e._v("审核失败")]),n("el-radio",{attrs:{label:4}},[e._v("已删除")])],1)],1),n("el-form-item",{attrs:{label:"频道"}},[n("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.channelsId,callback:function(t){e.channelsId=t},expression:"channelsId"}},[n("el-option",{attrs:{label:"全部",value:null}}),e._l(e.channelList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),n("el-form-item",{attrs:{label:"日期"}},[n("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["12:00:00"],format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.pubDate,callback:function(t){e.pubDate=t},expression:"pubDate"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.loadArticles(1)}}},[e._v("查询")])],1)],1)],1),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("根据筛选条件共查询到 "+e._s(e.totalCount)+" 条结果：")])]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:e.articles,stripe:"",size:"mini"}},[n("el-table-column",{attrs:{prop:"date",label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.cover.images[0],fit:"cover",lazy:""}},[n("div",{staticClass:"image-slot",staticStyle:{"text-align":"center"},attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),n("span",{staticClass:"dot"},[e._v("...")])]),n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:a("cc64"),alt:""}})])])]}}])}),n("el-table-column",{attrs:{prop:"title",label:"标题"}}),n("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.articleStatus[t.row.status].type}},[e._v(e._s(e.articleStatus[t.row.status].text))])]}}])}),n("el-table-column",{attrs:{prop:"pubdate",label:"发布时间"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-edit",type:"primary"},on:{click:function(a){return e.$router.push("/publish?id="+t.row.id)}}}),n("el-button",{attrs:{size:"mini",type:"danger",circle:"",icon:"el-icon-delete"},on:{click:function(a){return e.delArticle(t.row.id)}}})]}}])})],1),n("el-pagination",{attrs:{layout:"prev, pager, next",total:e.totalCount,background:"",disabled:e.loading,"current-page":e.page},on:{"current-change":e.getCurrent,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1)],1)},X=[],Y=(a("25f0"),function(e){return x({method:"GET",url:"/mp/v1_0/articles",params:e})}),Z=function(){return x({method:"GET",url:"/mp/v1_0/channels"})},ee=function(e){return x({method:"DELETE",url:"/mp/v1_0/articles/".concat(e)})},te=function(e,t){return x({method:"POST",url:"/mp/v1_0/articles",params:{draft:t},data:e})},ae=function(e){return x({method:"GET",url:"/mp/v1_0/articles/".concat(e)})},ne=function(e,t,a){return x({method:"PUT",url:"/mp/v1_0/articles/".concat(e),params:{draft:a},data:t})},ie=function(e,t){return x({method:"PUT",url:"/mp/v1_0/comments/status",params:{article_id:e},data:{allow_comment:t}})},se={name:"ArticleIndex",data:function(){return{articles:[],form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},articleStatus:[{status:0,text:"草稿",type:"info"},{status:1,text:"待审核",type:""},{status:0,text:"审核通过",type:"success"},{status:0,text:"审核失败",type:"warning"},{status:0,text:"已删除",type:"danger"}],page:1,pageSize:10,totalCount:0,status:null,channelList:[],channelsId:null,pubDate:null,loading:!0}},created:function(){this.loadArticles(),this.loadArticleChannels()},methods:{loadArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,Y({page:t,per_page:this.pageSize,status:this.status,channel_id:this.channelsId,begin_pubdate:this.pubDate?this.pubDate[0]:null,end_pubdate:this.pubDate?this.pubDate[1]:null}).then((function(t){e.loading=!1;var a=t.data.data,n=a.total_count,i=a.results;e.articles=i,e.totalCount=n}))},getCurrent:function(e){this.loadArticles(e)},loadArticleChannels:function(){var e=this;Z().then((function(t){e.channelList=t.data.data.channels}))},delArticle:function(e){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){ee(e.toString()).then((function(e){t.loadArticles(t.page)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},re=se,oe=(a("46db"),Object(c["a"])(re,Q,X,!1,null,"08bcc13a",null)),le=oe.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"publish"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.id?"修改文章":"发布文章"))])],1)],1),a("el-form",{ref:"publish-form",attrs:{model:e.article,"label-width":"60px",rules:e.publishRules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.article.title,callback:function(t){e.$set(e.article,"title",t)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("el-tiptap",{attrs:{extensions:e.extensions,height:"350"},model:{value:e.article.content,callback:function(t){e.$set(e.article,"content",t)},expression:"article.content"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("el-radio-group",{model:{value:e.article.cover.type,callback:function(t){e.$set(e.article.cover,"type",t)},expression:"article.cover.type"}},[a("el-radio",{attrs:{label:1}},[e._v("单图")]),a("el-radio",{attrs:{label:3}},[e._v("三图")]),a("el-radio",{attrs:{label:0}},[e._v("无图")]),a("el-radio",{attrs:{label:-1}},[e._v("自动")])],1),e.article.cover.type>0?e._l(e.article.cover.type,(function(t,n){return a("upload-cover",{key:t,staticClass:"cover-container",model:{value:e.article.cover.images[n],callback:function(t){e.$set(e.article.cover.images,n,t)},expression:"article.cover.images[index]"}})})):e._e()],2),a("el-form-item",{attrs:{label:"频道",prop:"channel_id"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.article.channel_id,callback:function(t){e.$set(e.article,"channel_id",t)},expression:"article.channel_id"}},e._l(e.channels,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onPublish(!1)}}},[e._v(e._s(e.$route.query.id?"修改":"发布"))]),a("el-button",{on:{click:function(t){return e.onPublish(!0)}}},[e._v("存为草稿")])],1)],1)],1)],1)},ue=[],de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uploadCover",on:{click:e.showCoverSelect}},[a("div",{staticClass:"cover-wrap"},[a("img",{ref:"previewImage",staticClass:"cover-image",attrs:{src:e.value,alt:""}})]),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"收藏封面",name:"first"}},[a("image-list",{ref:"image-list",attrs:{"is-show-add":!1,"is-show-active":!1}})],1),a("el-tab-pane",{attrs:{label:"上传",name:"second"}},[a("input",{ref:"file",attrs:{type:"file"},on:{change:e.onFileChange}}),a("img",{ref:"preview-image",attrs:{width:"100"}})])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onCoverConfirm}},[e._v("确 定")])],1)],1)],1)},pe=[],me=(a("3ca3"),a("ddb0"),a("2b3d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"action-btn"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.onCollectChange},model:{value:e.collect,callback:function(t){e.collect=t},expression:"collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),e.isShowAdd?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("上传素材")]):e._e()],1),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],attrs:{gutter:10}},e._l(e.images,(function(t,n){return a("el-col",{key:t.id,attrs:{xs:12,sm:6,md:6,lg:4,xl:4},nativeOn:{click:function(t){e.selected=n}}},[a("div",{staticClass:"star-col"},[a("el-image",{staticClass:"star-image",attrs:{src:t.url,fit:"cover"}}),e.isShowSelected&&e.selected===n?a("div",{staticClass:"selected"}):e._e(),e.isShowActive?a("div",{staticClass:"star-handle"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.is_collected?"取消收藏":"添加收藏",placement:"top-start"}},[a("el-button",{attrs:{type:t.is_collected?"success":"warning",icon:t.is_collected?"el-icon-check":"el-icon-star-off",size:"mini",circle:"",loading:t.loading},on:{click:function(a){return e.onStarImage(t)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除此素材",placement:"top-start"}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",loading:t.loading},on:{click:function(a){return e.del(t)}}})],1)],1):e._e()],1)])})),1),a("el-dialog",{attrs:{title:"上传素材",visible:e.dialogVisible,width:"30%","before-close":e.handleClose,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",name:"image",headers:e.uploadheaders,"show-file-list":!0,"on-success":e.onUploadSuccess,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.page},on:{"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"current-change":e.currentChange}})],1)}),fe=[],ge=(a("4160"),a("159b"),function(e){return x({method:"POST",url:"/mp/v1_0/user/images",data:e})}),he=function(e){return x({method:"GET",url:"/mp/v1_0/user/images",params:e})},ve=function(e){return x({method:"DELETE",url:"/mp/v1_0/user/images/".concat(e)})},be=function(e,t){return x({method:"PUT",url:"/mp/v1_0/user/images/".concat(e),data:{collect:t}})},_e={props:{isShowAdd:{type:Boolean,default:!0},isShowActive:{type:Boolean,default:!0},isShowSelected:{type:Boolean,default:!0}},name:"ImageList",data:function(){var e=JSON.parse(window.localStorage.getItem("user"));return{collect:!1,images:[],dialogVisible:!1,uploadheaders:{Authorization:"Bearer ".concat(e.token)},total:0,page:1,pageSize:12,isLoading:!0,selected:null}},created:function(){this.loadImages(!1)},methods:{loadImages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isLoading=!0,he({collect:t,page:this.page,per_page:this.pageSize}).then((function(t){var a=t.data.data.results;a.forEach((function(e){e.loading=!1})),e.isLoading=!1,e.total=t.data.data.total_count,e.images=a}))},onCollectChange:function(e){this.page=1,this.loadImages(e)},handleClose:function(e){e()},onUploadSuccess:function(){this.dialogVisible=!1,this.loadImages(!1)},del:function(e){var t=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,ve(e.id).then((function(a){e.loading=!0,t.loadImages(!1),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},currentChange:function(e){this.page=e,this.loadImages(this.collect)},onStarImage:function(e){var t=this;e.loading=!0,be(e.id,!e.is_collected).then((function(a){e.loading=!1,t.loadImages(t.collect)}))}}},Ce=_e,we=(a("c2ac"),Object(c["a"])(Ce,me,fe,!1,null,"777e8606",null)),xe=we.exports,ye={props:["value"],components:{ImageList:xe},name:"uploadCover",data:function(){return{dialogVisible:!1,activeName:"first",previewImage:""}},methods:{showCoverSelect:function(){this.dialogVisible=!0},onFileChange:function(){var e=this.$refs.file,t=window.URL.createObjectURL(e.files[0]);this.$refs["preview-image"].src=t},onCoverConfirm:function(){var e=this;if("second"===this.activeName){var t=this.$refs.file.files[0];if(!t)return void this.$message("请选择图片");var a=new FormData;a.append("image",t),ge(a).then((function(t){e.dialogVisible=!1,e.$emit("input",t.data.data.url)}))}else if("first"===this.activeName){var n=this.$refs["image-list"],i=n.selected;if(null===i)return void this.$message("请选择图片");this.dialogVisible=!1,this.$emit("input",n.images[i].url)}}}},Se=ye,$e=(a("980e"),Object(c["a"])(Se,de,pe,!1,null,"26a5d37a",null)),ke=$e.exports,Ie=a("257f"),ze=(a("7eef"),{name:"PublishIndex",components:{"el-tiptap":Ie["ElementTiptap"],UploadCover:ke},data:function(){return{channels:[],article:{title:"",content:"",cover:{type:1,images:[]},channel_id:""},extensions:[new Ie["Doc"],new Ie["Text"],new Ie["Paragraph"],new Ie["Heading"]({level:5}),new Ie["Bold"]({bubble:!0}),new Ie["Underline"],new Ie["Italic"],new Ie["Strike"],new Ie["ListItem"],new Ie["BulletList"],new Ie["OrderedList"],new Ie["Image"]({uploadRequest:function(e){var t=new FormData;return t.append("image",e),ge(t).then((function(e){return e.data.data.url}))}})],publishRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:5,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],content:[{validator:function(e,t,a){"<p></p>"===t?a(new Error("内容不能为空")):a()}},{required:!0,message:"请输入内容",trigger:"blur"}],channel_id:[{required:!0,message:"请选择频道"}]}}},created:function(){this.getChannels(),this.$route.query.id&&this.getArticleInfo()},methods:{onPublish:function(e){var t=this;this.$refs["publish-form"].validate((function(a){a&&(t.$route.query.id?ne(t.$route.query.id,t.article,e).then((function(a){t.$message({message:"".concat(e?"存为草稿":"修改","成功"),type:"success"}),t.$router.push("/article")})):te(t.article,e).then((function(a){t.$message({message:e?"存为草稿成功":"发布内容成功",type:"success"}),t.$router.push("/article")})))}))},getChannels:function(){var e=this;Z().then((function(t){e.channels=t.data.data.channels}))},getArticleInfo:function(){var e=this;ae(this.$route.query.id).then((function(t){e.article=t.data.data}))}}}),Le=ze,Pe=Object(c["a"])(Le,ce,ue,!1,null,"af444768",null),Oe=Pe.exports,Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"imageIndex"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("素材管理")])],1)],1),a("image-list",{attrs:{"is-show-selected":!1}})],1)],1)},je=[],Te={name:"ImageIndex",components:{ImageList:xe}},Ae=Te,Ue=Object(c["a"])(Ae,Ee,je,!1,null,"55ff34a0",null),Ne=Ue.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commentIndex"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("评论管理")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.comments}},[a("el-table-column",{attrs:{prop:"title",label:"文章标题"}}),a("el-table-column",{attrs:{prop:"total_comment_count",label:"评论数量"}}),a("el-table-column",{attrs:{prop:"fans_comment_count",label:"粉丝评论数量"}}),a("el-table-column",{attrs:{label:"是否开启评论"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",disabled:t.row.loading},on:{change:function(a){return e.changeCommentStatus(t.row)}},model:{value:t.row.comment_status,callback:function(a){e.$set(t.row,"comment_status",a)},expression:"scope.row.comment_status"}})]}}])})],1),a("div",{staticStyle:{height:"30px"}}),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount,background:"",disabled:e.paginationDisabled},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1)],1)},De=[],qe={name:"commentIndex",data:function(){return{comments:[],totalCount:0,currentPage:1,pageSize:10,isLoading:!1,paginationDisabled:!1}},created:function(){this.loadComment(1)},methods:{loadComment:function(e){var t=this;this.paginationDisabled=!0,this.isLoading=!0,this.currentPage=e,Y({response_type:"comment",page:e,per_page:this.pageSize}).then((function(e){t.paginationDisabled=!1,t.isLoading=!1;var a=e.data.data.results;a.forEach((function(e){e.loading=!1})),t.comments=a,t.totalCount=e.data.data.total_count}))},changeCommentStatus:function(e){e.loading=!0,ie(e.id.toString(),e.comment_status).then((function(t){e.loading=!1}))},handleSizeChange:function(e){this.pageSize=e,this.loadComment(1)},handleCurrentChange:function(e){this.currentPage=e,this.loadComment(this.currentPage)}}},Re=qe,Be=Object(c["a"])(Re,Ve,De,!1,null,null,null),Fe=Be.exports,Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settingsIndex"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("个人设置")])],1)],1)]),a("el-col",{attrs:{span:12}},[a("el-form",{ref:"settings-form",attrs:{model:e.user,"label-width":"80px",rules:e.settingsRules}},[a("el-form-item",{attrs:{label:"编号"}},[e._v(" "+e._s(e.user.id)+" ")]),a("el-form-item",{attrs:{label:"手机"}},[e._v(" "+e._s(e.user.mobile)+" ")]),a("el-form-item",{attrs:{label:"媒体名称",prop:"name"}},[a("el-input",{model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),a("el-form-item",{attrs:{label:"媒体介绍",prop:"intro"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.user.intro,callback:function(t){e.$set(e.user,"intro",t)},expression:"user.intro"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.userInfoLoading},on:{click:e.onUpdateUserInfo}},[e._v("保存设置")])],1)],1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[a("label",{attrs:{for:"file"}},[a("el-avatar",{attrs:{shape:"square",size:180,fit:"cover",src:e.user.photo}}),a("p",[e._v("修改头像")])],1),a("input",{ref:"file",attrs:{type:"file",id:"file",hidden:""},on:{change:e.onFileChange}})])],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.omImageOpend}},[a("div",{staticClass:"imgContainer"},[a("img",{ref:"image",staticClass:"previewImage",attrs:{src:e.previewImage}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.photoLoading},on:{click:e.updateUserPhoto}},[e._v("确 定")])],1)])],1)},Ge=[],Je=(a("ac1f"),a("5319"),a("5fb1")),He=a.n(Je),We={name:"settingsIndex",data:function(){return{settingsRules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:1,max:7,message:"长度在 1 到 7 个字符",trigger:"blur"}],intro:[{required:!0,message:"请输入活动名称",trigger:"blur"}],email:[{required:!0,message:"请输入活动名称",trigger:"blur"},{pattern:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,message:"邮箱格式不正确",trigger:"blur"}]},user:{email:"",id:null,mobile:"",name:"",intro:"",photo:""},previewImage:"",dialogVisible:!1,cropper:"",photoLoading:!1,userInfoLoading:!1}},created:function(){this.uploadUser()},methods:{onFileChange:function(){var e=this.$refs.file,t=window.URL.createObjectURL(e.files[0]);this.previewImage=t,this.dialogVisible=!0,e.value=""},uploadUser:function(){var e=this;S().then((function(t){e.user=t.data.data}))},omImageOpend:function(){var e=this.$refs.image;this.cropper?this.cropper.replace(this.previewImage):this.cropper=new He.a(e,{viewMode:1,dragMode:"none",aspectRatio:1,cropBoxResizable:!1})},updateUserPhoto:function(){var e=this;this.photoLoading=!0,this.cropper.getCroppedCanvas().toBlob((function(t){var a=new FormData;a.append("photo",t),$(a).then((function(a){e.photoLoading=!1,e.dialogVisible=!1,e.user.photo=window.URL.createObjectURL(t),j.$emit("user-info",e.user)}))}))},onUpdateUserInfo:function(){var e=this;this.$refs["settings-form"].validate((function(t){if(t){e.userInfoLoading=!0;var a=e.user,n=a.name,i=a.intro,s=a.email;k({name:n,intro:i,email:s}).then((function(t){j.$emit("user-info",e.user),e.userInfoLoading=!1,e.$message({message:"修改成功",type:"success"})}))}}))}}},Ke=We,Qe=(a("cd03"),Object(c["a"])(Ke,Me,Ge,!1,null,"f7c7ee48",null)),Xe=Qe.exports,Ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fansIndex"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:"/"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("粉丝管理")])],1)],1),a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"粉丝列表",name:"fansList"}},[a("fans-list")],1),a("el-tab-pane",{attrs:{label:"粉丝画像",name:"fansPortrayal"}},[a("fans-portrayal")],1)],1)],1)],1)},Ze=[],et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fansList"},[a("div",{staticClass:"mask",class:{isShow:e.maskShow}},[e._m(0)]),a("el-row",{attrs:{gutter:10}},e._l(e.fans,(function(t,n){return a("el-col",{key:n,attrs:{xs:12,sm:6,md:4,lg:3,xl:1}},[a("div",{staticClass:"theFan"},[a("img",{staticClass:"fansAva",attrs:{src:t.photo}}),a("p",{staticClass:"fansName"},[e._v(e._s(t.name))]),a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"success",plain:""}},[e._v("+关注")])],1)])])})),1),a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[20,30,40,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1)},tt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loading"},[a("span",[e._v("loading...")])])}],at=function(e){return x({method:"GET",url:"/mp/v1_0/followers",params:e})},nt={name:"fansListIndex",data:function(){return{fans:[],currentPage:1,pageSize:20,totalCount:0,maskShow:!1}},created:function(){this.onFans(1)},methods:{onFans:function(e){var t=this;this.maskShow=!0,at({page:e,per_page:this.pageSize}).then((function(e){t.maskShow=!1,t.fans=e.data.data.results,t.totalCount=e.data.data.total_count}))},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.onFans(1)},handleCurrentChange:function(e){this.currentPage=e,this.onFans(e)}}},it=nt,st=(a("dcb3"),Object(c["a"])(it,et,tt,!1,null,"35283b06",null)),rt=st.exports,ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fansPort"},[a("div",{ref:"main",staticClass:"main"})])},lt=[],ct=a("164e"),ut=a.n(ct),dt={name:"fansPort",mounted:function(){var e=ut.a.init(this.$refs.main),t={title:{text:""},tooltip:{},legend:{data:["销量"]},xAxis:{data:["Mon","Tue","Wed","Thu","Fir","Sat","Sun"]},yAxis:{},series:[{type:"bar",data:[10,52,200,334,390,330,220]}]};e.setOption(t)}},pt=dt,mt=(a("2165"),Object(c["a"])(pt,ot,lt,!1,null,"41be9f80",null)),ft=mt.exports,gt={name:"fansIndex",data:function(){return{activeName:"fansList"}},components:{FansList:rt,FansPortrayal:ft}},ht=gt,vt=Object(c["a"])(ht,Ye,Ze,!1,null,null,null),bt=vt.exports;i.a.use(p["a"]);var _t=[{path:"/login",name:"login",component:P},{path:"/",component:F,children:[{path:"",name:"home",component:K},{path:"/article",name:"article",component:le},{path:"/publish",name:"publish",component:Oe},{path:"/image",name:"image",component:Ne},{path:"/comment",name:"comment",component:Fe},{path:"/settings",name:"settings",component:Xe},{path:"/fans",name:"fans",component:bt}]}],Ct=new p["a"]({routes:_t});Ct.beforeEach((function(e,t,a){var n=JSON.parse(window.localStorage.getItem("user"));"/login"!==e.path?n?a():a("/login"):a()}));var wt=Ct;i.a.use(Ie["ElementTiptapPlugin"],{lang:"zh",spellcheck:!0}),i.a.use(C.a),i.a.config.productionTip=!1,new i.a({router:wt,render:function(e){return e(d)}}).$mount("#app")},"5f72":function(e,t){e.exports=ELEMENT},"5fb1":function(e,t){e.exports=cropper},"602b":function(e,t,a){},"8bbf":function(e,t){e.exports=Vue},"980e":function(e,t,a){"use strict";var n=a("ed29"),i=a.n(n);i.a},"9be3":function(e,t,a){},bca0:function(e,t,a){},c2ac:function(e,t,a){"use strict";var n=a("bca0"),i=a.n(n);i.a},ca18:function(e,t,a){"use strict";var n=a("602b"),i=a.n(n);i.a},cc64:function(e,t,a){e.exports=a.p+"img/20.995ee5a9.png"},cd03:function(e,t,a){"use strict";var n=a("e6e8"),i=a.n(n);i.a},cfa5:function(e,t,a){"use strict";var n=a("0403"),i=a.n(n);i.a},dcb3:function(e,t,a){"use strict";var n=a("df82"),i=a.n(n);i.a},df82:function(e,t,a){},e6e8:function(e,t,a){},ed29:function(e,t,a){},edcd:function(e,t,a){}});
//# sourceMappingURL=app.0d120b37.js.map